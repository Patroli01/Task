<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FocusTask Dashboard</title>
    
    <!-- 1. Load Tailwind CSS (Styling) -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- 2. Load React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- 3. Load Babel (Untuk memproses JSX di browser) -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Style tambahan untuk scrollbar yang manis -->
    <style>
        body { font-family: 'Inter', sans-serif; }
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
        .dark ::-webkit-scrollbar-thumb { background: #475569; }
        .dark ::-webkit-scrollbar-thumb:hover { background: #64748b; }
        
        /* Animasi berdenyut untuk tombol mulai */
        @keyframes pulse-custom {
            0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(59, 130, 246, 0.7); }
            70% { transform: scale(1.05); box-shadow: 0 0 0 10px rgba(59, 130, 246, 0); }
            100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(59, 130, 246, 0); }
        }
        .animate-pulse-custom {
            animation: pulse-custom 2s infinite;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- ICONS COMPONENTS ---
        const Icon = ({ children, size = 20, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>{children}</svg>
        );
        const Layout = (props) => <Icon {...props}><rect width="18" height="18" x="3" y="3" rx="2" ry="2"/><line x1="3" x2="21" y1="9" y2="9"/><line x1="9" x2="9" y1="21" y2="9"/></Icon>;
        const Sun = (props) => <Icon {...props}><circle cx="12" cy="12" r="4"/><path d="M12 2v2"/><path d="M12 20v2"/><path d="m4.93 4.93 1.41 1.41"/><path d="m17.66 17.66 1.41 1.41"/><path d="M2 12h2"/><path d="M20 12h2"/><path d="m6.34 17.66-1.41 1.41"/><path d="m19.07 4.93-1.41 1.41"/></Icon>;
        const Moon = (props) => <Icon {...props}><path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"/></Icon>;
        const Plus = (props) => <Icon {...props}><path d="M5 12h14"/><path d="M12 5v14"/></Icon>;
        const Trash2 = (props) => <Icon {...props}><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/><line x1="10" x2="10" y1="11" y2="17"/><line x1="14" x2="14" y1="11" y2="17"/></Icon>;
        const Check = (props) => <Icon {...props}><polyline points="20 6 9 17 4 12"/></Icon>;
        const Clock = (props) => <Icon {...props}><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></Icon>;
        const Calendar = (props) => <Icon {...props}><rect width="18" height="18" x="3" y="4" rx="2" ry="2"/><line x1="16" x2="16" y1="2" y2="6"/><line x1="8" x2="8" y1="2" y2="6"/><line x1="3" x2="21" y1="10" y2="10"/></Icon>;
        const AlertCircle = (props) => <Icon {...props}><circle cx="12" cy="12" r="10"/><line x1="12" x2="12" y1="8" y2="12"/><line x1="12" x2="12.01" y1="16" y2="16"/></Icon>;
        const HelpCircle = (props) => <Icon {...props}><circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/><line x1="12" x2="12.01" y1="17" y2="17"/></Icon>;
        const X = (props) => <Icon {...props}><line x1="18" x2="6" y1="6" y2="18"/><line x1="6" x2="18" y1="6" y2="18"/></Icon>;
        const Volume2 = (props) => <Icon {...props}><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"/><path d="M15.54 8.46a5 5 0 0 1 0 7.07"/><path d="M19.07 4.93a10 10 0 0 1 0 14.14"/></Icon>;
        const VolumeX = (props) => <Icon {...props}><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"/><line x1="22" x2="16" y1="9" y2="15"/><line x1="16" x2="22" y1="9" y2="15"/></Icon>;
        const ShieldCheck = (props) => <Icon {...props}><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/><path d="m9 12 2 2 4-4"/></Icon>;

        // --- MAIN APP COMPONENT ---
        const App = () => {
            // State
            const [tasks, setTasks] = useState(() => {
                const saved = localStorage.getItem('focusTask_data');
                return saved ? JSON.parse(saved) : [];
            });
            const [newTask, setNewTask] = useState('');
            const [priority, setPriority] = useState('normal');
            const [greeting, setGreeting] = useState('');
            const [darkMode, setDarkMode] = useState(true);
            const [showHelp, setShowHelp] = useState(false);
            const [hasStarted, setHasStarted] = useState(false); // Menangani Autoplay Block
            const [soundEnabled, setSoundEnabled] = useState(() => {
                const saved = localStorage.getItem('focusTask_sound');
                return saved !== null ? JSON.parse(saved) : true;
            });

            // Audio Refs
            const addAudio = useRef(new Audio('https://assets.mixkit.co/active_storage/sfx/2568/2568-preview.mp3'));
            const completeAudio = useRef(new Audio('https://assets.mixkit.co/active_storage/sfx/2013/2013-preview.mp3'));

            // Effects
            useEffect(() => {
                localStorage.setItem('focusTask_data', JSON.stringify(tasks));
            }, [tasks]);

            useEffect(() => {
                localStorage.setItem('focusTask_sound', JSON.stringify(soundEnabled));
            }, [soundEnabled]);

            useEffect(() => {
                const hour = new Date().getHours();
                if (hour < 11) setGreeting('Selamat Pagi');
                else if (hour < 15) setGreeting('Selamat Siang');
                else if (hour < 18) setGreeting('Selamat Sore');
                else setGreeting('Selamat Malam');
            }, []);

            useEffect(() => {
                if (darkMode) {
                    document.documentElement.classList.add('dark');
                } else {
                    document.documentElement.classList.remove('dark');
                }
            }, [darkMode]);

            // Handlers Suara (Text-to-Speech)
            const speakText = (text) => {
                if (!soundEnabled || !window.speechSynthesis) return;
                
                // Batalkan suara yang sedang berjalan agar tidak tumpang tindih
                window.speechSynthesis.cancel();
                
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = 'id-ID'; // Menggunakan Bahasa Indonesia
                utterance.rate = 1.0;
                utterance.pitch = 1.0;
                
                window.speechSynthesis.speak(utterance);
            };

            const playSoundEffect = (type) => {
                if (!soundEnabled) return;
                const audio = type === 'add' ? addAudio.current : completeAudio.current;
                audio.currentTime = 0;
                audio.play().catch(e => console.log("Audio play blocked"));
            };

            // Memulai Sesi & Mengucapkan Sapaan Pertama
            const startDashboard = () => {
                setHasStarted(true);
                // Beri jeda sedikit agar transisi mulus baru bicara
                setTimeout(() => {
                    speakText(`${greeting}, Jendral. Siap memantau tugas hari ini?`);
                }, 500);
            };

            const handleAddTask = (e) => {
                e.preventDefault();
                if (!newTask.trim()) return;

                const item = {
                    id: Date.now(),
                    text: newTask,
                    completed: false,
                    priority: priority,
                    createdAt: new Date().toLocaleDateString('id-ID', { weekday: 'long', day: 'numeric', month: 'short' })
                };

                setTasks([item, ...tasks]);
                setNewTask('');
                setPriority('normal');
                playSoundEffect('add');
            };

            const toggleComplete = (id) => {
                const updatedTasks = tasks.map(t => {
                    if (t.id === id) {
                        const newStatus = !t.completed;
                        if (newStatus) {
                            playSoundEffect('complete');
                            // Opsional: Laptop bicara saat tugas selesai
                            // speakText(`Tugas selesai, Jendral.`);
                        }
                        return { ...t, completed: newStatus };
                    }
                    return t;
                });
                setTasks(updatedTasks);
            };

            const deleteTask = (id) => {
                setTasks(tasks.filter(t => t.id !== id));
            };

            const pendingCount = tasks.filter(t => !t.completed).length;

            // Tampilan Awal (Lapor Screen) untuk memicu suara
            if (!hasStarted) {
                return (
                    <div className={`min-h-screen flex items-center justify-center transition-colors duration-300 ${darkMode ? 'bg-slate-900' : 'bg-blue-50'}`}>
                        <div className="text-center p-8">
                            <div className="mb-6 inline-flex p-5 rounded-full bg-blue-500/10 text-blue-500 animate-pulse-custom">
                                <ShieldCheck size={64} />
                            </div>
                            <h1 className={`text-3xl font-bold mb-2 ${darkMode ? 'text-white' : 'text-slate-800'}`}>Lapor, Jendral!</h1>
                            <p className={`mb-8 opacity-70 ${darkMode ? 'text-slate-400' : 'text-slate-600'}`}>Dashboard tugas siap dipantau.</p>
                            <button 
                                onClick={startDashboard}
                                className="bg-blue-600 hover:bg-blue-500 text-white px-10 py-4 rounded-2xl font-bold text-lg shadow-xl shadow-blue-500/20 transition-all hover:scale-105 active:scale-95"
                            >
                                MASUK MARKAS
                            </button>
                        </div>
                    </div>
                );
            }

            return (
                <div className={`min-h-screen transition-colors duration-300 ${darkMode ? 'bg-slate-900 text-slate-100' : 'bg-gray-50 text-gray-800'} font-sans relative`}>
                
                {/* Navbar */}
                <nav className={`px-6 py-4 flex justify-between items-center ${darkMode ? 'bg-slate-800/50' : 'bg-white shadow-sm'}`}>
                    <div className="flex items-center gap-2">
                    <Layout className="text-blue-500" size={24} />
                    <h1 className="font-bold text-xl tracking-tight">FocusTask</h1>
                    </div>
                    <div className="flex items-center gap-2">
                        <button 
                            onClick={() => setSoundEnabled(!soundEnabled)}
                            title={soundEnabled ? "Matikan Suara" : "Aktifkan Suara"}
                            className={`p-2 rounded-full ${darkMode ? 'bg-slate-700 hover:bg-slate-600' : 'bg-gray-200 hover:bg-gray-300'} transition`}
                        >
                            {soundEnabled ? <Volume2 size={20} className="text-green-400" /> : <VolumeX size={20} className="text-red-400" />}
                        </button>
                        <button 
                            onClick={() => setShowHelp(true)}
                            className={`p-2 rounded-full ${darkMode ? 'bg-slate-700 hover:bg-slate-600 text-blue-400' : 'bg-blue-100 hover:bg-blue-200 text-blue-600'} transition`}
                        >
                            <HelpCircle size={20} />
                        </button>
                        <button 
                            onClick={() => setDarkMode(!darkMode)}
                            className={`p-2 rounded-full ${darkMode ? 'bg-slate-700 hover:bg-slate-600' : 'bg-gray-200 hover:bg-gray-300'} transition`}
                        >
                            {darkMode ? <Sun size={20} /> : <Moon size={20} />}
                        </button>
                    </div>
                </nav>

                <div className="max-w-3xl mx-auto px-4 py-8 md:py-12">
                    
                    {/* Hero Section */}
                    <div className="mb-10">
                    <h2 className="text-4xl md:text-5xl font-extrabold mb-2 bg-gradient-to-r from-blue-400 to-purple-500 bg-clip-text text-transparent">
                        {greeting}, Jendral.
                    </h2>
                    <p className={`text-lg ${darkMode ? 'text-slate-400' : 'text-gray-600'}`}>
                        {pendingCount > 0 
                        ? `Ada ${pendingCount} tugas yang menanti penyelesaianmu.` 
                        : "Semua tugas selesai! Nikmati harimu."}
                    </p>
                    </div>

                    {/* Input Section */}
                    <div className={`p-4 rounded-2xl mb-8 ${darkMode ? 'bg-slate-800 border border-slate-700' : 'bg-white shadow-lg border border-gray-100'}`}>
                    <form onSubmit={handleAddTask} className="flex flex-col md:flex-row gap-3">
                        <input
                        type="text"
                        placeholder="Apa yang perlu diselesaikan hari ini?"
                        value={newTask}
                        onChange={(e) => setNewTask(e.target.value)}
                        className={`flex-1 p-3 rounded-xl outline-none transition ${darkMode ? 'bg-slate-900 focus:ring-2 focus:ring-blue-500 text-white placeholder-slate-500' : 'bg-gray-50 focus:ring-2 focus:ring-blue-400 text-gray-900'}`}
                        />
                        
                        <select
                        value={priority}
                        onChange={(e) => setPriority(e.target.value)}
                        className={`p-3 rounded-xl outline-none cursor-pointer ${darkMode ? 'bg-slate-900 text-slate-300' : 'bg-gray-50 text-gray-700'}`}
                        >
                        <option value="normal">Normal</option>
                        <option value="high">Penting ðŸ”¥</option>
                        </select>

                        <button 
                        type="submit"
                        className="bg-blue-600 hover:bg-blue-500 text-white px-6 py-3 rounded-xl font-medium flex items-center justify-center gap-2 transition active:scale-95"
                        >
                        <Plus size={20} />
                        <span>Tambah</span>
                        </button>
                    </form>
                    </div>

                    {/* Task List */}
                    <div className="space-y-4">
                    {tasks.length === 0 && (
                        <div className={`text-center py-12 rounded-2xl border-2 border-dashed ${darkMode ? 'border-slate-800 text-slate-600' : 'border-gray-200 text-gray-400'}`}>
                        <Clock size={48} className="mx-auto mb-3 opacity-50" />
                        <p>Belum ada tugas. Tambahkan sesuatu untuk memulai!</p>
                        </div>
                    )}

                    {tasks.map(task => (
                        <div 
                        key={task.id}
                        className={`group flex items-center justify-between p-4 rounded-xl border transition-all duration-200 ${
                            task.completed 
                            ? (darkMode ? 'bg-slate-900/50 border-slate-800 opacity-50' : 'bg-gray-50 border-gray-100 opacity-60') 
                            : (darkMode ? 'bg-slate-800 border-slate-700 hover:border-slate-600' : 'bg-white border-gray-100 shadow-sm hover:shadow-md')
                        }`}
                        >
                        <div className="flex items-center gap-4 flex-1">
                            <button
                            onClick={() => toggleComplete(task.id)}
                            className={`w-6 h-6 rounded-full border-2 flex items-center justify-center transition-colors ${
                                task.completed
                                ? 'bg-green-500 border-green-500 text-white'
                                : (darkMode ? 'border-slate-500 hover:border-blue-400' : 'border-gray-300 hover:border-blue-500')
                            }`}
                            >
                            {task.completed && <Check size={14} strokeWidth={3} />}
                            </button>
                            
                            <div className="flex flex-col">
                            <span className={`text-lg transition-all ${task.completed ? 'line-through decoration-2 decoration-slate-500' : ''}`}>
                                {task.text}
                            </span>
                            <div className="flex items-center gap-3 text-xs mt-1">
                                <span className={`flex items-center gap-1 ${darkMode ? 'text-slate-500' : 'text-gray-400'}`}>
                                <Calendar size={12} /> {task.createdAt}
                                </span>
                                {task.priority === 'high' && !task.completed && (
                                <span className="text-red-400 font-semibold flex items-center gap-1 bg-red-400/10 px-2 py-0.5 rounded text-[10px] uppercase tracking-wider">
                                    <AlertCircle size={10} /> Prioritas Tinggi
                                </span>
                                )}
                            </div>
                            </div>
                        </div>

                        <button 
                            onClick={() => deleteTask(task.id)}
                            className={`p-2 rounded-lg opacity-0 group-hover:opacity-100 transition ${darkMode ? 'text-slate-500 hover:text-red-400 hover:bg-red-400/10' : 'text-gray-400 hover:text-red-500 hover:bg-red-50'}`}
                        >
                            <Trash2 size={18} />
                        </button>
                        </div>
                    ))}
                    </div>
                </div>

                {/* HELP MODAL */}
                {showHelp && (
                    <div className="fixed inset-0 z-50 flex items-center justify-center px-4 bg-black/60 backdrop-blur-sm transition-all">
                        <div className={`relative w-full max-w-md p-6 rounded-2xl shadow-2xl transform transition-all scale-100 ${darkMode ? 'bg-slate-800 text-slate-100 border border-slate-700' : 'bg-white text-gray-800'}`}>
                            <button onClick={() => setShowHelp(false)} className="absolute top-4 right-4 p-1 rounded-full hover:bg-gray-200/20 transition"><X size={20} /></button>
                            <h3 className="text-xl font-bold mb-4 flex items-center gap-2"><HelpCircle className="text-blue-500" /> Agar Muncul Otomatis</h3>
                            <div className="space-y-4 text-sm leading-relaxed">
                                <div className={`p-4 rounded-xl ${darkMode ? 'bg-slate-900/50' : 'bg-blue-50'}`}>
                                    <strong className="block mb-1 text-blue-500">Startup Browser</strong>
                                    <p>Settings Browser > On Startup > Open a specific page > Add current page.</p>
                                </div>
                                <div className={`p-4 rounded-xl ${darkMode ? 'bg-slate-900/50' : 'bg-purple-50'}`}>
                                    <strong className="block mb-1 text-purple-500">Startup Windows</strong>
                                    <p>Tekan <code>Win+R</code>, ketik <code>shell:startup</code>, lalu masukkan file <code>index.html</code> ke situ.</p>
                                </div>
                            </div>
                            <button onClick={() => setShowHelp(false)} className="w-full mt-6 bg-blue-600 hover:bg-blue-500 text-white py-3 rounded-xl font-medium transition">Siap, Mengerti!</button>
                        </div>
                    </div>
                )}

                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
